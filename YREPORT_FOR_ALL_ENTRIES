REPORT YREPORT_FOR_ALL_ENTRIES.

* TO CREATE A STRUCTURE USING MARA FIELD.
TYPES : BEGIN OF LTY_MARA,
        MATNR TYPE MATNR,
        MTART TYPE MTART,
        MBRSH TYPE MBRSH,
        MATKL TYPE MATKL,
        MEINS TYPE MEINS,
  END OF LTY_MARA.

* TO CREATE AN INTERNAL TABLE AND WORK-AREA OF LTY_MARA.
  DATA : IT_MARA TYPE TABLE OF LTY_MARA,
         WA_MARA TYPE LTY_MARA.

* TO CREATEA A STRUCTURE USING MARC FIELDS.
TYPES : BEGIN OF LTY_MARC,
         MATNR TYPE MATNR,
         WERKS TYPE WERKS_D,
         EKGRP TYPE EKGRP,
         MINBE TYPE MINBE,
         BSTMI TYPE BSTMI,
  END OF LTY_MARC.

* FETCH THE DATA FROM DATABASE TABLE MARA.
 SELECT MATNR MTART MBRSH MATKL MEINS FROM MARA INTO TABLE IT_MARA
   WHERE MATNR BETWEEN '000000000000000010' AND '000000000000000100'.

*IMPORTANT POINT FOR FOR ALL ENTRIES
*1.THE SPECIFIED TO CONSIDER WHILE USING FOR ALL ENTRIES.
*2.IN THE SELLECTION STATEMENT WHILE USING FOR ALL ENTRIES WE NEED TO CONSIDER ALL KEY FIELDS IN THE SELECTION LIST.
*3.IN THE SELLECTION STATEMENT WHILE USING FOR ALL ENTRIES WE NEED TO CONSIDER ALL KEY FIELDS IN THE SELECTION LIST.

  IF IT_MARA IS NOT INITIAL.
    SELECT MATNR WERKS EKGRP MINBE BSTMI FROM MARC INTO TABLE IT_MARC
      FOR ALL ENTRIES IN IT_MARA WHERE MATNR = IT_MARA-MATNR.

      ENDIF.

* TO CREATE A FINAL STRUCTURE WITH HELP OF IT_MARA AND IT_MARC.
TYPES : BEGIN OF LTY_FINAL,
        MATNR TYPE MATNR,
        MTART TYPE MTART,
        MBRSH TYPE MBRSH,
        MATKL TYPE MATKL,
        MEINS TYPE MEINS,
        WERKS TYPE WERKS_D,
        EKGRP TYPE EKGRP,
        MINBE TYPE MINBE,
        BSTMI TYPE BSTMI,
  END OF LTY_FINAL.


* TO CREATE AN INTERNAL TABLE AND WORK-AREA.
DATA : IT_FINAL TYPE TABLE OF LTY_FINAL,
       WA_FINAL TYPE LTY_FINAL.


* LOOP THE TABLE
  LOOP AT IT_MARC INTO WA_MARC.
    WA_FINAL-MATNR = WA_MARC-MATNR.
    WA_FINAL-WERKS = WA_MARC-WERKS.
    WA_FINAL-EKGRP = WA_MARC-EKGRP.
    WA_FINAL-MINBE = WA_MARC-MINBE.
    WA_FINAL-BSTMI = WA_MARC-BSTMI.

    READ TABLE IT_MARA INTO WA_MARA WITH KEY MATNR = WA_MARA-MATNR.
    IF SY-SUBRC = 0.
    WA_FINAL-MATNR = WA_MARA-MATNR.
    WA_FINAL-MTART = WA_MARA-MTART.
    WA_FINAL-MBRSH = WA_MARA-MBRSH.
    WA_FINAL-MATKL = WA_MARA_MATKL.
    WA_FINAL-MEINS = WA_MARA-MEINS.
    ENDIF.

    APPEND WA_FINAL TO IT_FINAL.
    CLEAR : WA_FINAL, WA_MARA, WA_MARC.

    ENDLOOP.

    WRITE : / 'NO OF RECORD IS FETCHED INTO IT_FINAL = ', SY-DBCNT.
    ULINE.

    LOOP AT IT_FINAL INTO WA_FINAL.
      WRITE : / WA_FINAL-MATNR,
                WA_FINAL-MTART,
                WA_FINAL-MBRSH,
                WA_FINAL-MATKL,
                WA_FINAL-WERKS,
                WA_FINAL-EKGRP,
                WA_FINAL-MINBE,
                WA_FINAL-BSTMI.
      ENDLOOP.
