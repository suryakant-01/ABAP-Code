*JOIN TWO TABLE AND DEVELOP THE REPORT USE TABLE KNA1 AND VBAK

REPORT ZJOIN_TWO_TABLE_REPORT1.

* STRUCTURE DECLARATION
TYPES : BEGIN OF LTY_KNA1,
        KUNNR TYPE KUNNR,
        LAND1 TYPE LAND1_GP,
        NAME1 TYPE NAME1_GP,
        ORT01 TYPE ORT01_GP,
  END OF LTY_KNA1.

TYPES : BEGIN OF LTY_VBAK,
        VBELN TYPE VBELN_VA,
        ERDAT TYPE ERDAT,
        ERZET TYPE ERZET,
        ERNAM TYPE ERNAM,
        KUNNR TYPE KUNNR,
    END OF LTY_VBAK.

TYPES : BEGIN OF LTY_FINAL,
        KUNNR TYPE KUNNR,
        LAND1 TYPE LAND1_GP,
        NAME1 TYPE NAME1_GP,
        ORT01 TYPE ORT01_GP,
        VBELN TYPE VBELN_VA,
        ERDAT TYPE ERDAT,
        ERZET TYPE ERZET,
        ERNAM TYPE ERNAM,
  END OF LTY_FINAL.

* INTERNAL TABLE AND WORK-AREA DECLARATION.

  DATA : IT_KNA1 TYPE TABLE OF LTY_KNA1,
         WA_KNA1 TYPE LTY_KNA1.

  DATA : IT_VBAK TYPE TABLE OF LTY_VBAK,
         WA_VBAK TYPE LTY_VBAK.

  DATA : IT_FINAL TYPE TABLE OF LTY_FINAL,
         WA_FINAL TYPE LTY_FINAL.

  DATA : K_KUNNR TYPE KUNNR.

** SELECTION SCREEN DESIGNING
  SELECTION-SCREEN BEGIN OF BLOCK  B1 WITH FRAME TITLE TEXT-100.
    SELECT-OPTIONS SO_KUNNR FOR K_KUNNR.
    SELECTION-SCREEN END OF BLOCK B1.


** FETCHING THE DATA FROM DATABASE TABLE.
    SELECT KUNNR LAND1 NAME1 ORT01 FROM KNA1 INTO TABLE IT_KNA1 WHERE KUNNR IN SO_KUNNR.

      IF IT_KNA1 IS NOT INITIAL.
         SELECT VBELN ERDAT ERZET ERNAM KUNNR FROM VBAK INTO TABLE IT_VBAK
            FOR ALL ENTRIES IN IT_KNA1 WHERE KUNNR = IT_KNA1-KUNNR.

           ENDIF.

** POPULATING THE DATA INTO FINAL INTERNAL TABLE.
   LOOP AT IT_KNA1 INTO WA_VBAK.
     WA_FINAL-VBELN = WA_VBAK-VBELN.
     WA_FINAL-ERDAT = WA_VBAK-ERDAT.
     WA_FINAL-ERZET = WA_VBAK-ERZET.
     WA_FINAL-ERNAM = WA_VBAK-ERNAM.
     WA_FINAL-KUNNR = WA_VBAK-KUNNR.

   READ TABLE IT_KNA1 INTO WA_VBAK WITH KEY KUNNR = WA_VBAK-KUNNR.
     IF SY-SUBRC = 0.
       WA_FINAL-LAND1 = WA_KNA1-LAND1.
       WA_FINAL-NAME1 = WA_KNA1-NAME1.
       WA_FINAL-ORT01 = WA_KNA1-ORT01.
       ENDIF.

       APPEND  WA_FINAL TO IT_FINAL.

       ENDLOOP.

**DISPLAY THE DATA
   LOOP AT IT_FINAL INTO WA_FINAL.
     WRITE :/ WA_FINAL-KUNNR,
               WA_FINAL-LAND1,
               WA_FINAL-NAME1,
               WA_FINAL-ORT01,
               WA_FINAL-VBELN,
               WA_FINAL-ERDAT,
               WA_FINAL-ERZET,
               WA_FINAL-ERNAM.

      ENDLOOP.
