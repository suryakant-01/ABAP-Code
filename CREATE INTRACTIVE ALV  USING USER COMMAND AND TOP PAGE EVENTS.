*TO CREATE INTRACTIVE ALV  USING USER COMMAND AND TOP PAGE EVENTS.
REPORT ZINTRACTIVE_ALV_REPORT_GUI_01.

* TO CREATE LINE TYPE STRUCTURE
TYPES : BEGIN OF LINE_TYPE,
        MATNR TYPE MATNR,
        ERSDA TYPE ERSDA,
        ERNAM TYPE ERNAM,
        MTART TYPE MTART,
        MBRSH TYPE MBRSH,
        MATKL TYPE MATKL,
        MEINS TYPE MEINS,
  END OF LINE_TYPE.

* TO CREATE VARIAABLE F_MATNO.
  DATA : F_MATNO TYPE MATNR.

* TO CREATE AN INTERNAL TABLE IT_MAT USING STRUCTURE MARA.
  DATA : IT_MAT TYPE TABLE OF LINE_TYPE.

* TO CREATE AN INTERNAL TABLE IT_FIELDCAT.
  DATA : IT_FCAT TYPE TABLE OF SLIS_FIELDCAT_ALV.

* TO CREATE WORK AREA WA_FCAT WITH STRUCTURE SLIS_FIELDCAT_ALV.
  DATA : WA_FCAT TYPE SLIS_FIELDCAT_ALV.

* TO CREATE INTERNAL TABLE IT_MARC USING STRUCTURE MARC.
  DATA : IT_MARC TYPE TABLE OF MARC.


* TO CREATE A RANGE INPUT FIELD ON SELECTION SCREEN.

  SELECT-OPTIONS S_MATNR FOR F_MATNO.


  START-OF-SELECTION.
  PERFORM GET_DATA.
  PERFORM BUILD_CATLOG.
  PERFORM DISPLAY_DATA.


FORM GET_DATA .
 SELECT MATNR ERSDA ERNAM MTART MBRSH MATKL MEINS FROM MARA INTO TABLE IT_MAT WHERE MATNR IN S_MATNR.
ENDFORM.



*&---------------------------------------------------------------------*
*&      Form  BUILD_CATLOG
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM BUILD_CATLOG .
  " COLUMN POSITION 1 > MATNR : MATERIAL NUMBER.

  WA_FCAT-COL_POS = 1. "POSITION OF THE COLUMN
  WA_FCAT-FIELDNAME = 'MATNR'.
  WA_FCAT-TABNAME = 'IT_MAT'.
  WA_FCAT-KEY = 'X'.
  WA_FCAT-JUST = 'C'.
*  WA_FCAT-HOTSPOT = 'X'. " USING HOTSPOT TO GET DATA IN SINGLE TAP.
  WA_FCAT-NO_ZERO = 'X'.
  WA_FCAT-EMPHASIZE = 'C101'.
  WA_FCAT-FIX_COLUMN = 'X'.
  WA_FCAT-SELTEXT_M = 'MATERIAL'.
  APPEND WA_FCAT TO IT_FCAT.
  CLEAR WA_FCAT.

  " COLUMN POSITION 2 > ERSDA :  DATA .

  WA_FCAT-COL_POS = 2. "POSITION OF THE COLUMN
  WA_FCAT-FIELDNAME = 'ERSDA'.
  WA_FCAT-TABNAME = 'IT_MAT'.
  WA_FCAT-JUST = 'C'.
  WA_FCAT-EMPHASIZE = 'C310'.
  WA_FCAT-EDIT_MASK = '__/__/____'.
  WA_FCAT-SELTEXT_M = 'CREATED ON'.
  APPEND WA_FCAT TO IT_FCAT.
  CLEAR WA_FCAT.


  " COLUMN POSITION 3 > ERNAM :  PERSON NAME WHO CREATED.

  WA_FCAT-COL_POS = 3. "POSITION OF THE COLUMN
  WA_FCAT-FIELDNAME = 'ERNAM'.
  WA_FCAT-TABNAME = 'IT_MAT'.
  WA_FCAT-JUST = 'C'.
  WA_FCAT-KEY = 'X'.
  WA_FCAT-EMPHASIZE = 'C301'.
  WA_FCAT-SELTEXT_M = 'CREATED BY'.
  APPEND WA_FCAT TO IT_FCAT.
  CLEAR WA_FCAT.


  " COLUMN POSITION 4 > MTART  : TYPE OF MATERIAL.

  WA_FCAT-COL_POS = 4. "POSITION OF THE COLUMN
  WA_FCAT-FIELDNAME = 'MTART'.
  WA_FCAT-TABNAME = 'IT_MAT'.
  WA_FCAT-JUST = 'C'.
  WA_FCAT-EMPHASIZE = 'C401'.
  WA_FCAT-SELTEXT_M = 'MATERIAL TYPE'.
  APPEND WA_FCAT TO IT_FCAT.
  CLEAR WA_FCAT.


    " COLUMN POSITION 5 > MBRSH  : INDUSTRY SECTOR.

  WA_FCAT-COL_POS = 5. "POSITION OF THE COLUMN
  WA_FCAT-FIELDNAME = 'MBRSH'.
  WA_FCAT-TABNAME = 'IT_MAT'.
  WA_FCAT-JUST = 'C'.
  WA_FCAT-EMPHASIZE = 'C501'.
  WA_FCAT-SELTEXT_M = 'INDUSTRY SECTOR'.
  APPEND WA_FCAT TO IT_FCAT.
  CLEAR WA_FCAT.


    " COLUMN POSITION 6 > MATKL  : MATERIAL GROUP.

  WA_FCAT-COL_POS = 6. "POSITION OF THE COLUMN
  WA_FCAT-FIELDNAME = 'MATKL'.
  WA_FCAT-TABNAME = 'IT_MAT'.
  WA_FCAT-JUST = 'C'.
  WA_FCAT-EMPHASIZE = 'C801'.
  WA_FCAT-SELTEXT_M = 'MATERIAL GROUP'.
  APPEND WA_FCAT TO IT_FCAT.
  CLEAR WA_FCAT.


     " COLUMN POSITION 7 > MEINS : UNIT OF MEASUREMENT OF MATERIAL.

  WA_FCAT-COL_POS = 7. "POSITION OF THE COLUMN
  WA_FCAT-FIELDNAME = 'MATKL'.
  WA_FCAT-TABNAME = 'IT_MAT'.
  WA_FCAT-JUST = 'C'.
  WA_FCAT-EMPHASIZE = 'C601'.
  WA_FCAT-SELTEXT_M = 'UNIT OF MEASUREMENT'.
  APPEND WA_FCAT TO IT_FCAT.
  CLEAR WA_FCAT.


ENDFORM.

FORM DISPLAY_DATA.
CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
  EXPORTING
   I_CALLBACK_PROGRAM                = SY-REPID "TO KNOW CURRENT PROGRAM NAME.
   I_CALLBACK_PF_STATUS_SET          = 'ATTACH_GUI' " PF_STATUS_SET EVENT TRIGGERED
   IT_FIELDCAT                       = IT_FCAT
   I_CALLBACK_USER_COMMAND           = 'DOUBLE_CLICK'
   I_CALLBACK_TOP_OF_PAGE            = 'TOP_OF_PAGE_HEADING'
  " I_GRID_TITLE                      = 'MATERIAL MASTER DATA' " TO DISPLAY TITLE ON OUTPUT ALV GRID

  TABLES
    T_OUTTAB                          = IT_MAT " DISPLAY INTERNAL TABLE DATA OUTPUT SCREEN ALV GRID.
  EXCEPTIONS
    PROGRAM_ERROR                     = 1
    OTHERS                            = 2
          .
IF SY-SUBRC <> 0.
* Implement suitable error handling here
ENDIF.
ENDFORM.



FORM TOP_OF_PAGE_HEADING.

* TO CREATE AN INTERNAL TABLE IT_LIST REFERING INTERNAL TABLE DATA TYPE SLIS_T_LISTHEADER FROM TYPE GROUP SLIS.
DATA : IT_LIST TYPE SLIS_T_LISTHEADER.

* TO CREATE WORK - AREA WA_LIST WITH STRUCTURE SLIS_T_LISTHEADER FROM  GROUP SLIS.
DATA : WA_LIST TYPE SLIS_LISTHEADER.

* TO FILL THE INTERNAL TABLE IT_LIST USING WA_LIST BASED ON FIELD OF STRUCTURE SLIS_LISTHEADER.
  WA_LIST-TYP = 'H'. " >> HEADER
  WA_LIST-KEY = 'MATNR'.
  WA_LIST-INFO = 'MATERIAL DETAILS'.
  APPEND WA_LIST TO IT_LIST.

* REUSE_ALV_COMMENTARY_WRITE : THIS FUNCTION MODULE IS USED TO DISPLAY THE LIST HEADING ANF LOGO ON ALV_GRID >> OUTPUT SCREEN.
 CALL FUNCTION 'REUSE_ALV_COMMENTARY_WRITE'
   EXPORTING
     IT_LIST_COMMENTARY       = IT_LIST
     I_LOGO                   = 'SURYA_COMP'
*    I_END_OF_LIST_GRID       =
*    I_ALV_FORM               =
           .

ENDFORM.

*WHEN THE USER DOUBLE CLICKS ON ALV GRID THE EVENT 'USER COMMAND' TRIGGERS AND
*RESPECTIVE SUBROUTINE IS CALLED AND EXECUTED AUTOMATICALLY BY PASSING 2 PARAMENTER FUCTION
* CODE AND WORK AREA STRUCTURE  SLIS_SELFIELD WHICH HAS SOME GROUP OF FIELDS
*SUCH AS TABINDEX , FIELDNAME AND VALUE.

FORM DOUBLE_CLICK USING V_FCODE TYPE SY-UCOMM
                        WA TYPE SLIS_SELFIELD.
* FOR CONVERSION EXIT MATN1 INPUT: THIS FUNCTION MODULE USED TO CONVERT DISPALY FORMAT DATA (999)
* TO INTERNAL TABLE FORMAT DATA(0000000000000000999)

CALL FUNCTION 'CONVERSION_EXIT_MATN1_INPUT'
  EXPORTING
    INPUT              = WA-VALUE
  IMPORTING
    OUTPUT             = WA-VALUE(18)
  EXCEPTIONS
    LENGTH_ERROR       = 1
    OTHERS             = 2
          .
IF SY-SUBRC <> 0.
* Implement suitable error handling here
ENDIF.

* SYNTAX : SET PARAMETER
   SET PARAMETER ID 'MAT' FIELD WA-VALUE. "TO STORE DATA IN SAP MEMRORY
*
CASE V_FCODE. "V_FCODE REFERS TO RESPECTIVE FUNCTION BUTTON.

  WHEN '&IC1' OR 'FUNC1' OR 'DISP'.
* TO PLANT DATA FROM MARC INTO INTERNAL TABLE IT_MARC.
SELECT MATNR WERKS PSTAT LVORM FROM MARC INTO TABLE IT_MARC WHERE MATNR = WA-VALUE.
  IF SY-SUBRC = 0.
CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
 EXPORTING

    I_CALLBACK_PROGRAM                = SY-REPID

    I_STRUCTURE_NAME                  = 'MARC'

    I_GRID_TITLE                      = 'PLANT DATA'

  TABLES
    T_OUTTAB                          = IT_MARC
  EXCEPTIONS
    PROGRAM_ERROR                     = 1
    OTHERS                            = 2
          .
IF SY-SUBRC <> 0.
* Implement suitable error handling here
ENDIF.


ELSE.
  SHIFT WA-VALUE LEFT DELETING LEADING '0'.
  MESSAGE | PLANT DATA NOT FOUND - { WA-VALUE } | TYPE 'I'.
  ENDIF.
   WHEN 'FUNC2' OR 'LEAVE'.
    LEAVE PROGRAM.
    WHEN 'CODE1'.
      SUBMIT ZINTRACTIVE_ALV_REPORT01 AND RETURN.
      WHEN 'CODE2'.
        CALL TRANSACTION 'MM03' AND SKIP FIRST SCREEN.
        ENDCASE.


ENDFORM.


FORM ATTACH_GUI USING IT_FCODES TYPE SLIS_T_EXTAB.

  SET PF-STATUS 'GUI_STATUS'.

  ENDFORM.
