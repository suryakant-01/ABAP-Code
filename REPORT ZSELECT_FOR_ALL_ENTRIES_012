REPORT ZSELECT_FOR_ALL_ENTRIES_012.


* TO CREATE SOME STRUCTURE OF MARA TABLE.
TYPES :BEGIN OF LTY_MARA,
       MATNR TYPE MATNR,
       MTART TYPE MTART,
       MBRSH TYPE MBRSH,
       MATKL TYPE MATKL,
       MEINS TYPE MEINS,
  END OF LTY_MARA.

* TO CREATE SOME STRUCTURE OF MARC TABLE.
TYPES : BEGIN OF LTY_MARC,
        MATNR TYPE MATNR,
        WERKS TYPE WERKS_D,
        EKGRP TYPE EKGRP,
        BSTMI TYPE BSTMI,
        MINBE TYPE MINBE,
  END OF LTY_MARC.

* TO CREATE FINAL STRUCTURE USING MARA AND MARC STRUCTURE FIELDS.
TYPES : BEGIN OF LTY_FINAL,
        MATNR TYPE MATNR,
        MTART TYPE MTART,
        MBRSH TYPE MBRSH,
        MATKL TYPE MATKL,
        MEINS TYPE MEINS,
        WERKS TYPE WERKS_D,
        EKGRP TYPE EKGRP,
        BSTMI TYPE BSTMI,
        MINBE TYPE MINBE,
  END OF LTY_FINAL.

* TO CREATE AN INTERNAL TABLE AND WORK-AREA OF STRUCTURES.

  "********* FOR MARA ******************
  DATA : IT_MARA TYPE TABLE OF LTY_MARA.
  DATA : WA_MARA TYPE LTY_MARA.

  "********* FOR MARC ******************
  DATA : IT_MARC TYPE TABLE OF LTY_MARC.
  DATA : WA_MARC TYPE LTY_MARC.

  "********** FOR FINAL STRUCTURE ******
  DATA : IT_FINAL TYPE TABLE OF LTY_FINAL.
  DATA : WA_FINAL TYPE LTY_FINAL.

****************** FETCHED DATA FROM DB TABLE MARA *************************

  SELECT MATNR MTART MBRSH MATKL MEINS FROM MARA INTO TABLE IT_MARA
    WHERE MATNR BETWEEN '000000000000000010' AND '000000000000000099'.

****************** DO FOR ALL ENTREIS *****************

    IF IT_MARA IS NOT INITIAL.
      SELECT MATNR WERKS EKGRP MINBE BSTMI FROM MARC INTO TABLE IT_MARC FOR ALL ENTRIES IN IT_MARA WHERE MATNR = IT_MARA-MATNR.
        ENDIF.


******************** LOOP TABLE ***********************
LOOP AT IT_MARC INTO WA_MARC.
     WA_FINAL-MATNR = WA_MARC-MATNR.
     WA_FINAL-WERKS = WA_MARC-WERKS.
     WA_FINAL-EKGRP = WA_MARC-EKGRP.
     WA_FINAL-MINBE = WA_MARC-MINBE.
     WA_FINAL-BSTMI = WA_MARC-BSTMI.

READ TABLE IT_MARA INTO WA_MARA WITH KEY MATNR = WA_MARC-MATNR.
     IF SY-SUBRC = 0.
     WA_FINAL-MTART = WA_MARA-MTART.
     WA_FINAL-MBRSH = WA_MARA-MBRSH.
     WA_FINAL-MATKL = WA_MARA-MATKL.
     WA_FINAL-MEINS = WA_MARA-MEINS.

   ENDIF.

   APPEND WA_FINAL TO IT_FINAL.
   CLEAR : WA_FINAL, WA_MARA, WA_MARC.
   ENDLOOP.

   WRITE : / ' NO RECORD FETCHED = ',SY-DBCNT.
   ULINE.

*********** LOOP FINAL ************************
   LOOP AT IT_FINAL INTO WA_FINAL.
    WRITE : / WA_FINAL-MATNR,
              WA_FINAL-MTART,
              WA_FINAL-MBRSH,
              WA_FINAL-MATKL,
              WA_FINAL-WERKS,
              WA_FINAL-EKGRP,
              WA_FINAL-MINBE,
              WA_FINAL-BSTMI.
           ENDLOOP.
